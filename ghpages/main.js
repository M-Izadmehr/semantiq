/*! For license information please see main.js.LICENSE.txt */
(()=>{"use strict";var t={data:null,cache:new Map,maxCacheSize:100,init:function(t){this.data=t,this.cache.clear()},decode:function(t){if(this.cache.has(t))return this.cache.get(t);try{var e=this._decodeFromQuantized(t);return this._addToCache(t,e),e}catch(e){return console.error("Failed to decode embedding for index ".concat(t,":"),e),null}},_decodeFromQuantized:function(t){if(!this.data)throw new Error("Embeddings not initialized");for(var e=this.data.embeddings_q8,n=atob(e),r=new Uint8Array(n.length),i=0;i<n.length;i++)r[i]=n.charCodeAt(i);var o=this.data.shape[1],s=t*o;if(s+o>r.length)throw new Error("Invalid word index: ".concat(t));for(var a=r.slice(s,s+o),c=this.data,u=c.emb_min,l=(c.emb_max,c.emb_scale),d=new Float32Array(o),h=0;h<o;h++)d[h]=a[h]/l+u;return d},_addToCache:function(t,e){if(this.cache.size>=this.maxCacheSize){var n=this.cache.keys().next().value;this.cache.delete(n)}this.cache.set(t,e)},similarity:function(t,e){if(!t||!e)return console.error("Invalid embeddings for similarity calculation"),0;for(var n=0,r=0,i=0,o=0;o<t.length;o++)n+=t[o]*e[o],r+=t[o]*t[o],i+=e[o]*e[o];var s=Math.sqrt(r)*Math.sqrt(i);return 0===s?0:n/s},decodeCoordinates:function(t){if(!this.data.coordinates_q8)return null;try{for(var e=atob(this.data.coordinates_q8),n=new Uint8Array(e.length),r=0;r<e.length;r++)n[r]=e.charCodeAt(r);var i=2*t;if(i+1>=n.length)throw new Error("Invalid coordinate index for word ".concat(t));var o=n[i],s=n[i+1],a=this.data,c=a.coord_min,u=a.coord_max,l=a.coord_scale;return{x:(o/l+c-c)/(u-c),y:(s/l+c-c)/(u-c)}}catch(e){return console.error("Failed to decode coordinates for index ".concat(t,":"),e),null}},clearCache:function(){this.cache.clear()}};function e(t){return function(t){if(Array.isArray(t))return n(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return n(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var r={dataLoaded:!1,pendingGuesses:[],data:null,maxWordSample:1,timezone:"America/Toronto",launchDateStr:"2025-08-01",targetWord:"",targetEmbedding:null,targetIndex:-1,guesses:[],isWon:!1,hintsUsed:0,currentSort:"similarity-desc",currentDateStr:null,STORAGE_KEY:"semantiquest.v1.daily.progress",init:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"America/Toronto",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"2025-08-01";this.data=t,this.maxWordSample=e,this.timezone=n,this.launchDateStr=r},resetForDate:function(t){this.guesses=[],this.isWon=!1,this.hintsUsed=0,this.currentSort="similarity-desc",this.currentDateStr=t,this.pickTargetForDate(t)},enqueuePendingGuess:function(t){this.pendingGuesses.push({word:t,timestamp:Date.now()})},drainPendingGuesses:function(t){var n=e(this.pendingGuesses);this.pendingGuesses=[],n.forEach(function(e){return t(e.word)})},pickTargetForDate:function(e){var n=Math.floor(this.data.words.length*this.maxWordSample),r=this._pickIndexDeterministic(e,n);this.targetIndex=r,this.targetWord=this.data.words[this.targetIndex],this.targetEmbedding=t.decode(this.targetIndex)},validateWord:function(t){if(!t)return{valid:!1,reason:"Please enter a word"};if(t.length>50)return{valid:!1,reason:"Word too long"};if(!/^[a-z]+$/.test(t))return{valid:!1,reason:"Only single words allowed"};var e=this.data.words.indexOf(t);return-1===e?{valid:!1,reason:"Word not in vocabulary"}:{valid:!0,index:e}},hasGuessed:function(t){return this.guesses.some(function(e){return e.word===t})},addGuess:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i={word:t,similarity:e,index:n,timestamp:Date.now(),guessNumber:this.guesses.length+1,rank:this.calculateRank(e),isHint:r};return this.guesses.push(i),i},calculateRank:function(t){return t>=.9?Math.floor(1+100*(1-t)):t>=.8?Math.floor(100+1e3*(.9-t)):t>=.6?Math.floor(1100+2e3*(.8-t)):t>=.4?Math.floor(5100+5e3*(.6-t)):Math.floor(10100+1e4*(.4-t))},getBestGuess:function(){return this.guesses.length?this.guesses.reduce(function(t,e){return e.similarity>t.similarity?e:t}):null},getSortedGuesses:function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null)||this.currentSort,n=e(this.guesses);switch(t){case"similarity-desc":return n.sort(function(t,e){return e.similarity-t.similarity});case"similarity-asc":return n.sort(function(t,e){return t.similarity-e.similarity});case"order-desc":return n.sort(function(t,e){return e.guessNumber-t.guessNumber});case"order-asc":return n.sort(function(t,e){return t.guessNumber-e.guessNumber});default:return n}},getStats:function(){var t=this.getBestGuess();return{guessCount:this.guesses.length,bestScore:t?t.similarity:0,bestRank:t?t.rank:null,targetWord:this.isWon?this.targetWord:"???",hintsUsed:this.hintsUsed}},getTodayDateStr:function(){return new Intl.DateTimeFormat("en-CA",{timeZone:this.timezone}).format(new Date)},isToday:function(t){return t===this.getTodayDateStr()},isFutureDate:function(t){return this._cmpDate(t,this.getTodayDateStr())>0},offsetDate:function(t,e){var n=new Date(t+"T00:00:00");return n.setUTCDate(n.getUTCDate()+e),n.toISOString().slice(0,10)},getDailyNumber:function(t){var e=new Date(this.launchDateStr+"T00:00:00Z"),n=new Date(t+"T00:00:00Z");return Math.floor((n-e)/864e5)+1},_loadStore:function(){try{return JSON.parse(localStorage.getItem(this.STORAGE_KEY)||"{}")}catch(t){return{}}},_saveStore:function(t){localStorage.setItem(this.STORAGE_KEY,JSON.stringify(t))},saveProgress:function(t){var e=this._loadStore();e[t]={targetWord:this.targetWord,targetIndex:this.targetIndex,isWon:this.isWon,hintsUsed:this.hintsUsed,guesses:this.guesses},this._saveStore(e)},restoreProgress:function(e){var n=this._loadStore()[e];if(!n)return!1;var r=this._pickIndexDeterministic(e,Math.floor(this.data.words.length*this.maxWordSample)),i=this.data.words[r];return n.targetWord===i&&(this.targetIndex=n.targetIndex,this.targetWord=n.targetWord,this.targetEmbedding=t.decode(this.targetIndex),this.guesses=n.guesses||[],this.isWon=!!n.isWon,this.hintsUsed=n.hintsUsed||0,!0)},clearProgressForDate:function(t){var e=this._loadStore();delete e[t],this._saveStore(e)},_pickIndexDeterministic:function(t,e){var n=this._xmur3(t+"|semantiquest")(),r=this._mulberry32(n);return Math.floor(r()*e)},_cmpDate:function(t,e){return t===e?0:t<e?-1:1},_xmur3:function(t){for(var e=1779033703^t.length,n=0;n<t.length;n++)e=(e=Math.imul(e^t.charCodeAt(n),3432918353))<<13|e>>>19;return function(){return e=Math.imul(e^e>>>16,2246822507),e=Math.imul(e^e>>>13,3266489909),(e^=e>>>16)>>>0}},_mulberry32:function(t){return function(){var e=t+=1831565813;return e=Math.imul(e^e>>>15,1|e),(((e^=e+Math.imul(e^e>>>7,61|e))^e>>>14)>>>0)/4294967296}}};function i(t,e){if(t){if("string"==typeof t)return o(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(t,e):void 0}}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var s={elements:{},latestGuessNumber:-1,notificationTimeout:null,init:function(){this.elements={guessInput:document.getElementById("guess-input"),guessBtn:document.getElementById("guess-btn"),hintBtn:document.getElementById("hint-btn"),semanticMap:document.getElementById("semantic-map"),guessCount:document.getElementById("guess-count"),bestScore:document.getElementById("best-score"),targetWord:document.getElementById("target-word"),currentRank:document.getElementById("current-rank"),guessHistory:document.getElementById("guess-history"),mobileSortBtn:document.getElementById("sort-btn-mobile"),sortButtons:{"similarity-desc":document.getElementById("sort-similarity-desc"),"similarity-asc":document.getElementById("sort-similarity-asc"),"order-desc":document.getElementById("sort-order-desc"),"order-asc":document.getElementById("sort-order-asc")},victoryModal:document.getElementById("victory-modal"),victoryWord:document.getElementById("victory-word"),victoryGuesses:document.getElementById("victory-guesses"),newGameBtn:document.getElementById("btn-new-game"),dailyTitle:document.getElementById("daily-title"),dailyDate:document.getElementById("daily-date"),prevDayBtn:document.getElementById("btn-prev-day"),nextDayBtn:document.getElementById("btn-next-day")}},reset:function(){this.elements.semanticMap.innerHTML="",this.elements.guessHistory.innerHTML='\n            <div style="text-align: center; opacity: 0.6; padding: 20px;">\n                No guesses yet. Start exploring!\n            </div>\n        ',this.elements.targetWord.textContent="???",this.elements.victoryModal.classList.add("hidden"),this.elements.guessInput.value="",this.elements.guessInput.focus(),this.updateSortButtons("similarity-desc"),this.updateMobileSortButton("similarity-desc");var t=document.getElementById("hint-area");t&&t.remove(),this.clearNotifications()},updateStats:function(t){this.elements.guessCount.textContent=t.guessCount,this.elements.bestScore.textContent=(100*t.bestScore).toFixed(1),this.elements.currentRank.textContent=t.bestRank||"-",this.elements.targetWord.textContent=t.targetWord},addWordToMap:function(t){var e=this.elements.semanticMap,n=e.offsetWidth,r=e.offsetHeight,i=this._getWordPosition(t,n,r),o=this._createWordDot(t,i);e.appendChild(o)},_getWordPosition:function(e,n,r){var i,o,s=40,a=t.decodeCoordinates(e.index);if(a)i=a.x*(n-80)+s,o=a.y*(r-80)+s;else{var c=2*Math.random()*Math.PI,u=(1-e.similarity)*Math.min(n,r)*.3+50;i=n/2+Math.cos(c)*u,o=r/2+Math.sin(c)*u}return{x:i=Math.max(s,Math.min(n-s,i)),y:o=Math.max(s,Math.min(r-s,o))}},_createWordDot:function(t,e){var n=Math.max(30,30+30*t.similarity),r=document.createElement("div");return r.className="word-dot ".concat(this._getSimilarityClass(t.similarity)),r.style.left="".concat(e.x-n/2,"px"),r.style.top="".concat(e.y-n/2,"px"),r.style.width="".concat(n,"px"),r.style.height="".concat(n,"px"),r.style.fontSize="".concat(Math.max(10,8+6*t.similarity),"px"),r.textContent=t.word,r.title="".concat(t.word,": ").concat((100*t.similarity).toFixed(1),"% similarity"),r},_getSimilarityClass:function(t){return t>=.8?"dot-burning":t>=.6?"dot-hot":t>=.4?"dot-warm":t>=.2?"dot-cool":"dot-cold"},_getSimilarityLabel:function(t){return t>=.8?"BURNING":t>=.6?"HOT":t>=.4?"WARM":t>=.2?"COOL":"COLD"},updateGuessHistory:function(t,e){var n=this;if(0!==t.length){var r="",i=t[t.length-1],o=i.guessNumber===t.length;if(r+=this._formatGuessItem(i,o?"latest":"recent"),t.length>1&&(r+='<div class="guess-separator"></div>'),t.length>1){var s=t.slice(0,-1);this._sortGuesses(s,e).forEach(function(t){r+=n._formatGuessItem(t)})}this.elements.guessHistory.innerHTML=r}else this.elements.guessHistory.innerHTML='\n                <div style="text-align: center; opacity: 0.6; padding: 20px;">\n                    No guesses yet. Start exploring!\n                </div>\n            '},_formatGuessItem:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(null==t.similarity)return'\n      <div class="guess-item '.concat(e,'">\n        <span>').concat(t.isHint?"💡 ":"").concat(t.guessNumber," - ").concat(t.word,'</span>\n        <span class="similarity-score">⏳ scoring…</span>\n      </div>\n    ');var n=this._getSimilarityClass(t.similarity),r=this._getSimilarityLabel(t.similarity);return'\n            <div class="guess-item '.concat(e,'">\n                <span>').concat(t.isHint?"💡 ":"").concat(t.guessNumber," - ").concat(t.word,'</span>\n                <span class="similarity-score ').concat(n,'">\n                    ').concat((100*t.similarity).toFixed(1),"% - ").concat(r,"\n                </span>\n            </div>\n        ")},_sortGuesses:function(t,e){var n,r=function(t){if(Array.isArray(t))return o(t)}(n=t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(n)||i(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}();switch(e){case"similarity-desc":return r.sort(function(t,e){return e.similarity-t.similarity});case"similarity-asc":return r.sort(function(t,e){return t.similarity-e.similarity});case"order-desc":return r.sort(function(t,e){return e.guessNumber-t.guessNumber});case"order-asc":return r.sort(function(t,e){return t.guessNumber-e.guessNumber});default:return r}},updateSortButtons:function(t){Object.entries(this.elements.sortButtons).forEach(function(e){var n,r,o=(r=2,function(t){if(Array.isArray(t))return t}(n=e)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,s,a=[],c=!0,u=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(a.push(r.value),a.length!==e);c=!0);}catch(t){u=!0,i=t}finally{try{if(!c&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(u)throw i}}return a}}(n,r)||i(n,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),s=o[0],a=o[1];s===t?a.classList.add("active"):a.classList.remove("active")})},updateMobileSortButton:function(t){this.elements.mobileSortBtn.textContent="Sort: ".concat({"similarity-desc":"🔥 Best First","similarity-asc":"❄️ Worst First","order-desc":"🕒 Latest First","order-asc":"📅 Oldest First"}[t])},showTargetArea:function(e,n){var r,i,o=this.elements.semanticMap,s=o.offsetWidth,a=o.offsetHeight,c=n.words.indexOf(e),u=t.decodeCoordinates(c);u?(r=u.x*(s-80)+40,i=u.y*(a-80)+40):(r=s/2,i=a/2);var l=document.createElement("div");l.className="hint-area",l.id="hint-area";var d=.15*Math.min(s,a);l.style.left="".concat(r-d,"px"),l.style.top="".concat(i-d,"px"),l.style.width="".concat(2*d,"px"),l.style.height="".concat(2*d,"px"),o.appendChild(l)},showNotification:function(t){this.notificationTimeout&&clearTimeout(this.notificationTimeout);var e=document.getElementById("hint-notification");e&&e.remove();var n=document.createElement("div");n.id="hint-notification",n.className="hint-notification",n.textContent=t,document.body.appendChild(n),this.notificationTimeout=setTimeout(function(){n.parentNode&&n.remove()},4e3)},clearNotifications:function(){var t=document.getElementById("hint-notification");t&&t.remove(),this.notificationTimeout&&(clearTimeout(this.notificationTimeout),this.notificationTimeout=null)},showVictory:function(t,e){this.elements.victoryWord.textContent=t,this.elements.victoryGuesses.textContent=e,this.elements.victoryModal.classList.remove("hidden")},updateTargetWord:function(t){this.elements.targetWord.textContent=t},updateHintButton:function(t){var e=this.elements.hintBtn;switch(t){case"loading":break;case"ready":default:e.classList.remove("loading"),e.textContent="💡 Hint",e.disabled=!1;break;case"disabled":e.classList.remove("loading"),e.textContent="💡 Hint",e.disabled=!0}},updateDailyHeader:function(t){var e=t.dateStr,n=t.dailyNumber;this.elements.dailyTitle.textContent="Daily #".concat(n),this.elements.dailyDate.textContent=e},setNextDisabled:function(t){this.elements.nextDayBtn.disabled=!!t,this.elements.nextDayBtn.style.opacity=t?.5:1,this.elements.nextDayBtn.style.cursor=t?"not-allowed":"pointer"},addPendingGuess:function(t,e){var n={word:t,similarity:null,index:-1,guessNumber:(document.querySelectorAll("#guess-history .guess-item").length||0)+1},r=this.elements.semanticMap,i=r.offsetWidth,o=r.offsetHeight,s=i/2+(Math.random()-.5)*Math.min(i,o)*.1,a=o/2+(Math.random()-.5)*Math.min(i,o)*.1,c=document.createElement("div");c.className="word-dot dot-cool",c.style.left="".concat(s-15,"px"),c.style.top="".concat(a-15,"px"),c.style.width="".concat(30,"px"),c.style.height="".concat(30,"px"),c.style.fontSize="12px",c.textContent=t,c.title="".concat(t,": scoring..."),r.appendChild(c);var u=this.elements.guessHistory,l=document.createElement("div");l.className="guess-item latest",l.innerHTML="\n    <span>".concat(e?"💡 ":"").concat(n.guessNumber," - ").concat(t,'</span>\n    <span class="similarity-score">⏳ scoring…</span>\n  '),u.prepend(l)}};function a(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function o(n,r,i,o){var a=r&&r.prototype instanceof u?r:u,l=Object.create(a.prototype);return c(l,"_invoke",function(n,r,i){var o,a,c,u=0,l=i||[],d=!1,h={p:0,n:0,v:t,a:f,f:f.bind(t,4),d:function(e,n){return o=e,a=0,c=t,h.n=n,s}};function f(n,r){for(a=n,c=r,e=0;!d&&u&&!i&&e<l.length;e++){var i,o=l[e],f=h.p,m=o[2];n>3?(i=m===r)&&(c=o[(a=o[4])?5:(a=3,3)],o[4]=o[5]=t):o[0]<=f&&((i=n<2&&f<o[1])?(a=0,h.v=r,h.n=o[1]):f<m&&(i=n<3||o[0]>r||r>m)&&(o[4]=n,o[5]=r,h.n=m,a=0))}if(i||n>1)return s;throw d=!0,r}return function(i,l,m){if(u>1)throw TypeError("Generator is already running");for(d&&1===l&&f(l,m),a=l,c=m;(e=a<2?t:c)||!d;){o||(a?a<3?(a>1&&(h.n=-1),f(a,c)):h.n=c:h.v=c);try{if(u=2,o){if(a||(i="next"),e=o[i]){if(!(e=e.call(o,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,a<2&&(a=0)}else 1===a&&(e=o.return)&&e.call(o),a<2&&(c=TypeError("The iterator does not provide a '"+i+"' method"),a=1);o=t}else if((e=(d=h.n<0)?c:n.call(r,h))!==s)break}catch(e){o=t,a=1,c=e}finally{u=1}}return{value:e,done:d}}}(n,i,o),!0),l}var s={};function u(){}function l(){}function d(){}e=Object.getPrototypeOf;var h=[][r]?e(e([][r]())):(c(e={},r,function(){return this}),e),f=d.prototype=u.prototype=Object.create(h);function m(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,c(t,i,"GeneratorFunction")),t.prototype=Object.create(f),t}return l.prototype=d,c(f,"constructor",d),c(d,"constructor",l),l.displayName="GeneratorFunction",c(d,i,"GeneratorFunction"),c(f),c(f,i,"Generator"),c(f,r,function(){return this}),c(f,"toString",function(){return"[object Generator]"}),(a=function(){return{w:o,m}})()}function c(t,e,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}c=function(t,e,n,r){function o(e,n){c(t,e,function(t){return this._invoke(e,n,t)})}e?i?i(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(o("next",0),o("throw",1),o("return",2))},c(t,e,n,r)}function u(t,e,n,r,i,o,s){try{var a=t[o](s),c=a.value}catch(t){return void n(t)}a.done?e(c):Promise.resolve(c).then(r,i)}function l(t){return function(){var e=this,n=arguments;return new Promise(function(r,i){var o=t.apply(e,n);function s(t){u(o,r,i,s,a,"next",t)}function a(t){u(o,r,i,s,a,"throw",t)}s(void 0)})}}var d={worker:null,isCalculating:!1,lastRequestId:0,cachedHint:null,targetWord:null,init:function(t){var e=this;return l(a().m(function n(){return a().w(function(n){for(;;)if(0===n.n)return n.a(2,new Promise(function(n,r){try{e.worker=new Worker("./hint-worker.js"),e.worker.onmessage=function(t){return e._handleWorkerMessage(t)},e.worker.onerror=function(t){console.error("Hint worker error:",t),r(t)},e.worker.postMessage({type:"INIT",data:t}),e.worker.addEventListener("message",function t(e){"INIT_COMPLETE"===e.data.type&&(this.removeEventListener("message",t),console.log("Hint system initialized"),n())})}catch(t){console.error("Failed to initialize hint system:",t),r(t)}}))},n)}))()},reset:function(t){this.targetWord=t,this.cachedHint=null,this.isCalculating=!1,this.lastRequestId=0,this.worker&&this.worker.postMessage({type:"NEW_GAME",targetWord:t})},requestHint:function(t){this.isCalculating?console.log("Hint calculation already in progress"):this.cachedHint&&t&&this.cachedHint.similarity>t.similarity?console.log("Cached hint still valid"):(this.isCalculating=!0,this.lastRequestId++,this.worker.postMessage({type:"CALCULATE_HINT",requestId:this.lastRequestId,bestGuess:t?{word:t.word,similarity:t.similarity,index:t.index}:null}))},getHint:function(){var t=this;return l(a().m(function e(){var n;return a().w(function(e){for(;;)switch(e.n){case 0:if(!t.cachedHint){e.n=1;break}return n=t.cachedHint,t.cachedHint=null,e.a(2,n);case 1:if(!t.isCalculating){e.n=2;break}return e.a(2,new Promise(function(e){setTimeout(function(){e(t.cachedHint)},1e3)}));case 2:return e.a(2,null)}},e)}))()},_handleWorkerMessage:function(t){var e=t.data,n=e.type,r=e.requestId,i=e.data;switch(n){case"INIT_COMPLETE":console.log("Hint worker initialized");break;case"HINT_READY":if(r!==this.lastRequestId)return void console.log("Ignoring outdated hint response");this.cachedHint=i,this.isCalculating=!1,console.log("Hint ready:",(null==i?void 0:i.word)||"none",(null==i?void 0:i.similarity)||"none");var o=document.getElementById("hint-btn");o&&(o.classList.remove("loading"),o.textContent="💡 Hint");break;case"CALCULATION_COMPLETE":r===this.lastRequestId&&(this.isCalculating=!1);break;case"ERROR":console.error("Hint worker error:",i),this.isCalculating=!1}},destroy:function(){this.worker&&(this.worker.terminate(),this.worker=null)}};function h(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function o(n,r,i,o){var c=r&&r.prototype instanceof a?r:a,u=Object.create(c.prototype);return f(u,"_invoke",function(n,r,i){var o,a,c,u=0,l=i||[],d=!1,h={p:0,n:0,v:t,a:f,f:f.bind(t,4),d:function(e,n){return o=e,a=0,c=t,h.n=n,s}};function f(n,r){for(a=n,c=r,e=0;!d&&u&&!i&&e<l.length;e++){var i,o=l[e],f=h.p,m=o[2];n>3?(i=m===r)&&(c=o[(a=o[4])?5:(a=3,3)],o[4]=o[5]=t):o[0]<=f&&((i=n<2&&f<o[1])?(a=0,h.v=r,h.n=o[1]):f<m&&(i=n<3||o[0]>r||r>m)&&(o[4]=n,o[5]=r,h.n=m,a=0))}if(i||n>1)return s;throw d=!0,r}return function(i,l,m){if(u>1)throw TypeError("Generator is already running");for(d&&1===l&&f(l,m),a=l,c=m;(e=a<2?t:c)||!d;){o||(a?a<3?(a>1&&(h.n=-1),f(a,c)):h.n=c:h.v=c);try{if(u=2,o){if(a||(i="next"),e=o[i]){if(!(e=e.call(o,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,a<2&&(a=0)}else 1===a&&(e=o.return)&&e.call(o),a<2&&(c=TypeError("The iterator does not provide a '"+i+"' method"),a=1);o=t}else if((e=(d=h.n<0)?c:n.call(r,h))!==s)break}catch(e){o=t,a=1,c=e}finally{u=1}}return{value:e,done:d}}}(n,i,o),!0),u}var s={};function a(){}function c(){}function u(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(f(e={},r,function(){return this}),e),d=u.prototype=a.prototype=Object.create(l);function m(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,f(t,i,"GeneratorFunction")),t.prototype=Object.create(d),t}return c.prototype=u,f(d,"constructor",u),f(u,"constructor",c),c.displayName="GeneratorFunction",f(u,i,"GeneratorFunction"),f(d),f(d,i,"Generator"),f(d,r,function(){return this}),f(d,"toString",function(){return"[object Generator]"}),(h=function(){return{w:o,m}})()}function f(t,e,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}f=function(t,e,n,r){function o(e,n){f(t,e,function(t){return this._invoke(e,n,t)})}e?i?i(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(o("next",0),o("throw",1),o("return",2))},f(t,e,n,r)}function m(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function g(t,e,n,r,i,o,s){try{var a=t[o](s),c=a.value}catch(t){return void n(t)}a.done?e(c):Promise.resolve(c).then(r,i)}function y(t){return function(){var e=this,n=arguments;return new Promise(function(r,i){var o=t.apply(e,n);function s(t){g(o,r,i,s,a,"next",t)}function a(t){g(o,r,i,s,a,"throw",t)}s(void 0)})}}var v=null;function p(){return(p=y(h().m(function e(){var n,i,o;return h().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,s.init(),r.init({},1),b(),console.time("fetch-start"),e.n=1,fetch("embeddings_quantized.json");case 1:if(n=e.v,console.timeEnd("fetch-start"),n.ok){e.n=2;break}throw new Error("Failed to load game data: ".concat(n.status));case 2:return console.time("json-parse-start"),e.n=3,n.json();case 3:return i=e.v,console.timeEnd("json-parse-start"),console.log("gameData: ",i),r.data=i,r.dataLoaded=!0,t.init(i),e.n=4,d.init(i);case 4:T(v=r.getTodayDateStr()),r.drainPendingGuesses(function(t){var e,n;return S(null==t||null===(e=t.toLowerCase())||void 0===e||null===(n=e.trim)||void 0===n?void 0:n.call(e))}),e.n=6;break;case 5:e.p=5,o=e.v,console.error("Init error:",o),s.showNotification("Having trouble loading data. Keep guessing—we’ll score as soon as it connects.");case 6:return e.a(2)}},e,null,[[0,5]])}))).apply(this,arguments)}function b(){s.elements.guessBtn.addEventListener("click",S),s.elements.hintBtn.addEventListener("click",x),s.elements.guessInput.addEventListener("keypress",function(t){"Enter"!==t.key||r.isWon||S()}),s.elements.mobileSortBtn.addEventListener("click",I),Object.entries(s.elements.sortButtons).forEach(function(t){var e,n,i=(n=2,function(t){if(Array.isArray(t))return t}(e=t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,s,a=[],c=!0,u=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(a.push(r.value),a.length!==e);c=!0);}catch(t){u=!0,i=t}finally{try{if(!c&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(u)throw i}}return a}}(e,n)||function(t,e){if(t){if("string"==typeof t)return m(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?m(t,e):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=i[0];i[1].addEventListener("click",function(){return t=o,r.currentSort=t,s.updateSortButtons(t),void s.updateGuessHistory(r.guesses,t);var t})}),s.elements.prevDayBtn.addEventListener("click",function(){w(r.offsetDate(v,-1))}),s.elements.nextDayBtn.addEventListener("click",function(){var t=r.offsetDate(v,1);r.isFutureDate(t)||w(t)}),s.elements.newGameBtn.addEventListener("click",function(){r.clearProgressForDate(v),T(v)}),s.elements.guessInput.focus()}function w(t){r.saveProgress(v),T(v=t)}function S(){var e,n,i,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!r.isWon){var c=(null==o||null===(e=o.trim)||void 0===e||null===(e=e.call(o))||void 0===e?void 0:e.toLowerCase())||(null===(n=s.elements.guessInput.value)||void 0===n||null===(i=n.trim)||void 0===i||null===(i=i.call(n))||void 0===i?void 0:i.toLowerCase());if(c){if(!r.dataLoaded)return/^[a-z]+$/.test(c)?(s.addPendingGuess(c,a),r.enqueuePendingGuess(c,a),s.showNotification("Scoring in a moment—keep guessing!"),s.elements.guessInput.value="",void s.elements.guessInput.focus()):void s.showNotification("Only single words allowed");var u=r.validateWord(c);if(u.valid)if(r.hasGuessed(c))s.showNotification("Already guessed!");else{var l=r.data.words.indexOf(c),h=t.decode(l),f=t.similarity(h,r.targetEmbedding),m=r.addGuess(c,f,l,a);s.addWordToMap(m,a),s.updateGuessHistory(r.guesses,r.currentSort),s.updateStats(r.getStats()),r.saveProgress(v),c===r.targetWord?(r.isWon=!0,s.showVictory(r.targetWord,r.guesses.length),s.updateTargetWord(r.targetWord),r.saveProgress(v)):d.requestHint(r.getBestGuess()),s.elements.guessInput.value="",s.elements.guessInput.focus()}else s.showNotification(u.reason)}}}function x(){return E.apply(this,arguments)}function E(){return(E=y(h().m(function t(){var e,n,i;return h().w(function(t){for(;;)switch(t.n){case 0:if(!r.isWon){t.n=1;break}return t.a(2);case 1:if(0!==r.hintsUsed){t.n=2;break}return s.showTargetArea(r.targetWord,r.data),r.hintsUsed++,s.updateStats(r.getStats()),r.saveProgress(v),s.showNotification("💡 Target area revealed!"),t.a(2);case 2:return t.n=3,d.getHint();case 3:if(i=t.v){t.n=4;break}return s.updateHintButton("loading"),s.showNotification("No hints available right now. Keep guessing!"),t.a(2);case 4:s.showNotification("💡 Try: ".concat(i.word)),S(null===(e=i.word)||void 0===e||null===(e=e.toLowerCase())||void 0===e||null===(n=e.trim)||void 0===n?void 0:n.call(e),!0),r.hintsUsed++,s.updateStats(r.getStats()),r.saveProgress(v);case 5:return t.a(2)}},t)}))).apply(this,arguments)}function I(){var t=["similarity-desc","similarity-asc","order-desc","order-asc"],e=t.indexOf(r.currentSort),n=t[(e+1)%t.length];r.currentSort=n,s.updateMobileSortButton(n),s.updateSortButtons(n),s.updateGuessHistory(r.guesses,n)}function T(t){r.resetForDate(t),s.updateDailyHeader({dateStr:t,dailyNumber:r.getDailyNumber(t)}),s.setNextDisabled(r.isToday(t));var e=r.restoreProgress(t);s.reset(),e&&r.guesses.length?(r.guesses.forEach(function(t){return s.addWordToMap(t)}),s.updateGuessHistory(r.guesses,r.currentSort),r.hintsUsed>0&&s.showTargetArea(r.targetWord,r.data),r.isWon&&(s.showVictory(r.targetWord,r.guesses.length),s.updateTargetWord(r.targetWord)),d.reset(r.targetWord),d.requestHint(r.getBestGuess())):(d.reset(r.targetWord),d.requestHint(null)),s.updateStats(r.getStats()),s.elements.guessInput.focus()}function W(t){var e;"GET_EMBEDDINGS_VERSION"===(t.data||{}).action&&(null===(e=t.ports[0])||void 0===e||e.postMessage({version:"v1.0.0"}))}"serviceWorker"in navigator&&window.addEventListener("load",function(){navigator.serviceWorker.register("sw.js").then(function(t){console.log("SW registered:",t.scope),navigator.serviceWorker.addEventListener("message",W)}).catch(function(t){console.log("SW registration failed:",t)})});var k={clearCache:function(){return y(h().m(function t(){var e;return h().w(function(t){for(;;)switch(t.n){case 0:if(!("serviceWorker"in navigator)||!navigator.serviceWorker.controller){t.n=1;break}return e=new MessageChannel,t.a(2,new Promise(function(t){e.port1.onmessage=function(e){t(e.data.success)},navigator.serviceWorker.controller.postMessage({action:"CLEAR_EMBEDDINGS_CACHE"},[e.port2])}));case 1:return t.a(2,!1)}},t)}))()},invalidateVersion:function(t){return y(h().m(function e(){var n;return h().w(function(e){for(;;)switch(e.n){case 0:if(!("serviceWorker"in navigator)||!navigator.serviceWorker.controller){e.n=1;break}return n=new MessageChannel,e.a(2,new Promise(function(e){n.port1.onmessage=function(t){e(t.data.success)},navigator.serviceWorker.controller.postMessage({action:"INVALIDATE_VERSION",version:t},[n.port2])}));case 1:return e.a(2,!1)}},e)}))()}};window.CacheManager=k,window.addEventListener("load",function(){return p.apply(this,arguments)})})();